<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>music-app</title><meta name="description" content="Documentation for music-app"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">music-app</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> music-app </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#práctica-12---api-nodeexpress-de-gestión-de-información-musical" id="práctica-12---api-nodeexpress-de-gestión-de-información-musical" style="color: inherit; text-decoration: none;">
  <h1>Práctica 12 - API Node/Express de gestión de información musical</h1>
</a>

<a href="#desarrollo-de-sistemas-informáticos---universidad-de-la-laguna" id="desarrollo-de-sistemas-informáticos---universidad-de-la-laguna" style="color: inherit; text-decoration: none;">
  <h3>Desarrollo de Sistemas Informáticos - Universidad de La Laguna</h3>
</a>

<a href="#miembros" id="miembros" style="color: inherit; text-decoration: none;">
  <h4>Miembros:</h4>
</a>
<ul>
<li>Tanausú Falcón Casanova</li>
<li>Juan Marrero Domínguez</li>
<li>Diego Rodríguez Pérez</li>
</ul>

<a href="#1-introducción" id="1-introducción" style="color: inherit; text-decoration: none;">
  <h2>1. Introducción</h2>
</a>
<p>Se propone la implementación de un API REST, haciendo uso de Node/Express, que permita llevar a cabo operaciones de creación, lectura, modificación y borrado (Create, Read, Update, Delete - CRUD) de canciones, artistas y playlists. Los modelos de datos están alojados en el directorio <em>src/models</em>. Las diferentes opciones de modificado, borrado, etc se encuentran en el directorio <em>src/routers</em>. En cuanto a la documentación se ha generado mediante <em>TypeDoc</em>. Para verla simplemente tendremos que acceder al directorio <em>docs</em> y abrir el fichero <em>index.html</em>.</p>

<a href="#2-objetivos" id="2-objetivos" style="color: inherit; text-decoration: none;">
  <h2>2. Objetivos</h2>
</a>
<p>La realización de esta práctica tiene como objetivo aprender:</p>
<ul>
<li>La utilización de <em>node.js</em>.</li>
<li>Utilizar los módulos de <em>MongoDB</em>.</li>
<li>Comunicarse a través de <em>GitHub Issues</em>.</li>
</ul>

<a href="#3-implementación" id="3-implementación" style="color: inherit; text-decoration: none;">
  <h2>3. Implementación</h2>
</a>
<p>Vamos a dividir la implementación en modelos de datos y en routers. En los modelos de datos definiremos las entidades pedidas en la práctica, y los routers los utilizaremos para implementar las funcionalidades requeridas en realación a estos modelos.</p>

<a href="#modelo-de-datos-1---géneros-musicales-genre" id="modelo-de-datos-1---géneros-musicales-genre" style="color: inherit; text-decoration: none;">
  <h3>Modelo de Datos 1 - Géneros Musicales (<em>Genre</em>)</h3>
</a>

<a href="#código" id="código" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-3">Genre</span><span class="hl-1"> =</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;Rap&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Pop&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Trap&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Electro&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Classic&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Reggaeton&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Rock&quot;</span><span class="hl-1"> |</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;Country&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Popular&quot;</span><span class="hl-1"> | </span><span class="hl-4">&quot;Blues&quot;</span><span class="hl-1"> | </span><span class="hl-3">undefined</span>
</code></pre>

<a href="#explicación" id="explicación" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>En este modelo de datos se representa la información relativa a los Géneros Musicales. En este caso se definen simplemente los tipos de géneros musicales existentes.</p>

<a href="#modelo-de-datos-2---canciones-song" id="modelo-de-datos-2---canciones-song" style="color: inherit; text-decoration: none;">
  <h3>Modelo de Datos 2 - Canciones (<em>Song</em>)</h3>
</a>

<a href="#código-1" id="código-1" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">SongDocumentInterface</span><span class="hl-1"> </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-3">Document</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">author</span><span class="hl-1">: </span><span class="hl-3">ArtistDocumentInterface</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">duration</span><span class="hl-1">: {</span><span class="hl-5">min</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">, </span><span class="hl-5">sec</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">},</span><br/><span class="hl-1">  </span><span class="hl-5">genre</span><span class="hl-1">: </span><span class="hl-3">Genre</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-5">single</span><span class="hl-1">: </span><span class="hl-3">boolean</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">reproductions</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">SongSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">SongDocumentInterface</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">  </span><span class="hl-5">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">trim:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">author:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-5">Schema</span><span class="hl-1">.</span><span class="hl-5">Types</span><span class="hl-1">.</span><span class="hl-5">ObjectId</span><span class="hl-1">, </span><span class="hl-5">ref:</span><span class="hl-1"> </span><span class="hl-4">&#39;Artist&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">duration:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> {</span><span class="hl-5">min:</span><span class="hl-1"> </span><span class="hl-3">Number</span><span class="hl-1">, </span><span class="hl-5">sec:</span><span class="hl-1"> </span><span class="hl-3">Number</span><span class="hl-1">},</span><br/><span class="hl-1">    </span><span class="hl-5">default:</span><span class="hl-1"> {</span><span class="hl-5">min:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-5">sec:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">},</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">genre:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">trim:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enum:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;Rap&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Pop&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Trap&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Electro&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Classic&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Reggaeton&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;Rock&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Country&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Popular&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Blues&quot;</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">,</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">single:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">Boolean</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">default:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">reproductions:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">Number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">default:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">Song</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">SongDocumentInterface</span><span class="hl-1">&gt;(</span><span class="hl-4">&#39;Song&#39;</span><span class="hl-1">, </span><span class="hl-5">SongSchema</span><span class="hl-1">);</span>
</code></pre>

<a href="#explicación-1" id="explicación-1" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>En este modelo de datos se representa la información relativa a las Canciones. Cada canción cuenta con los siguientes atributos:</p>
<ul>
<li><strong>name</strong>: Contiene el nombre de la canción.</li>
<li><strong>author</strong>: Contiene el nombre del artista.</li>
<li><strong>duration</strong>: Duración de la canción.</li>
<li><strong>genre</strong>: Género(s) de la canción.</li>
<li><strong>isSingle</strong>: Información sobre si la canción es un <em>Single</em> o no.</li>
<li><strong>views</strong>: Reproducciones totales de la canción.</li>
</ul>

<a href="#modelo-de-datos-3---artistas-artist" id="modelo-de-datos-3---artistas-artist" style="color: inherit; text-decoration: none;">
  <h3>Modelo de Datos 3 - Artistas (<em>Artist</em>)</h3>
</a>

<a href="#código-2" id="código-2" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Document</span><span class="hl-1">, </span><span class="hl-5">Schema</span><span class="hl-1">, </span><span class="hl-5">model</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;mongoose&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">SongDocumentInterface</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;./song&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Genre</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;./genre&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">ArtistDocumentInterface</span><span class="hl-1"> </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-3">Document</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">genres</span><span class="hl-1">: </span><span class="hl-3">Genre</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-5">songs</span><span class="hl-1">: </span><span class="hl-3">SongDocumentInterface</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-5">monthlyListeners</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">ArtistSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">ArtistDocumentInterface</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">  </span><span class="hl-5">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">trim:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">genres:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">String</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">trim:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">enum:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;Rap&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Pop&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Trap&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Electro&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Classic&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Reggaeton&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;Rock&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Country&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Popular&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Blues&quot;</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">,</span><br/><span class="hl-1">      ],</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">songs:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-5">Schema</span><span class="hl-1">.</span><span class="hl-5">Types</span><span class="hl-1">.</span><span class="hl-5">ObjectId</span><span class="hl-1">, </span><span class="hl-5">ref:</span><span class="hl-1"> </span><span class="hl-4">&#39;Song&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">monthlyListeners:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">Number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">default:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">Artist</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">ArtistDocumentInterface</span><span class="hl-1">&gt;(</span><span class="hl-4">&#39;Artist&#39;</span><span class="hl-1">, </span><span class="hl-5">ArtistSchema</span><span class="hl-1">);</span>
</code></pre>

<a href="#explicación-2" id="explicación-2" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>En este modelo de datos se representa la información relativa a los Artistas. Cada artista cuenta con los siguientes atributos:</p>
<ul>
<li><strong>name</strong>: Contiene el nombre del artista.</li>
<li><strong>genre</strong>: Género(s) del artista.</li>
<li><strong>songs</strong> Canciones del artista</li>
<li><strong>monthlyListeners</strong>: Oyentes mensuales del artista.</li>
</ul>

<a href="#modelo-de-datos-4---playlists-playlist" id="modelo-de-datos-4---playlists-playlist" style="color: inherit; text-decoration: none;">
  <h3>Modelo de Datos 4 - PlayLists (<em>PlayList</em>)</h3>
</a>

<a href="#código-3" id="código-3" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Document</span><span class="hl-1">, </span><span class="hl-5">Schema</span><span class="hl-1">, </span><span class="hl-5">model</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;mongoose&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">SongDocumentInterface</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;./song&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Genre</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;./genre&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">PlaylistDocumentInterface</span><span class="hl-1"> </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-3">Document</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">genres</span><span class="hl-1">: </span><span class="hl-3">Genre</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-5">songs</span><span class="hl-1">: </span><span class="hl-3">SongDocumentInterface</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-5">duration</span><span class="hl-1">: {</span><span class="hl-5">min</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">, </span><span class="hl-5">sec</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">},</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">PlaylistSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">PlaylistDocumentInterface</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">  </span><span class="hl-5">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">trim:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">genres:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-3">String</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">trim:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">enum:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;Rap&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Pop&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Trap&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Electro&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Classic&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Reggaeton&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;Rock&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Country&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Popular&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;Blues&quot;</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">,</span><br/><span class="hl-1">      ],</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">songs:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-5">Schema</span><span class="hl-1">.</span><span class="hl-5">Types</span><span class="hl-1">.</span><span class="hl-5">ObjectId</span><span class="hl-1">, </span><span class="hl-5">ref:</span><span class="hl-1"> </span><span class="hl-4">&#39;Song&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">duration:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">type:</span><span class="hl-1"> {</span><span class="hl-5">min:</span><span class="hl-1"> </span><span class="hl-3">Number</span><span class="hl-1">, </span><span class="hl-5">sec:</span><span class="hl-1"> </span><span class="hl-3">Number</span><span class="hl-1">},</span><br/><span class="hl-1">    </span><span class="hl-5">default:</span><span class="hl-1"> {</span><span class="hl-5">min:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-5">sec:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">},</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">Playlist</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">PlaylistDocumentInterface</span><span class="hl-1">&gt;(</span><span class="hl-4">&#39;Playlist&#39;</span><span class="hl-1">, </span><span class="hl-5">PlaylistSchema</span><span class="hl-1">);</span>
</code></pre>

<a href="#explicación-3" id="explicación-3" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>En este modelo de datos se representa la información relativa a las PlayLists. Cada playlist cuenta con los siguientes atributos:</p>
<ul>
<li><strong>name</strong>: Contiene el nombre de la playlist.</li>
<li><strong>genre</strong>: Género(s) de la playlist.</li>
<li><strong>songs</strong> Canciones de la playlist</li>
<li><strong>duration</strong>: Duración total de la playlist.</li>
</ul>

<a href="#router-post" id="router-post" style="color: inherit; text-decoration: none;">
  <h3>Router Post</h3>
</a>

<a href="#código-4" id="código-4" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-5">express</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Playlist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/playlist&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Artist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/artist&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Song</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/song&#39;</span><span class="hl-1">;</span><br/><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">postRouter</span><span class="hl-1"> = </span><span class="hl-5">express</span><span class="hl-1">.</span><span class="hl-7">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-9">// Recibe peticiones para crear artistas</span><br/><span class="hl-5">postRouter</span><span class="hl-1">.</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">artist</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Artist</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">genres:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">genres</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-9">// Se almacenan los datos del artista</span><br/><span class="hl-1">  </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">().</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">artist</span><span class="hl-1">);</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para crear canciones</span><br/><span class="hl-5">postRouter</span><span class="hl-1">.</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-4">&#39;/song&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findOne</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">author</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Artist not found&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">song</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Song</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">author:</span><span class="hl-1"> </span><span class="hl-5">artist</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">duration:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">duration</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">genres:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">genres</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">single:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">single</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">reproductions:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">reproductions</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-9">// Se almacenan los datos de la canción</span><br/><span class="hl-1">      </span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">().</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">push</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">_id</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">monthlyListeners</span><span class="hl-1"> += </span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">reproductions</span><span class="hl-1">;</span><br/><br/><span class="hl-1">        </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">().</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">        }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para crear playlists</span><br/><span class="hl-5">postRouter</span><span class="hl-1">.</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1"> || !</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Name and songs must be provided for the playlist&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">Array</span><span class="hl-1">.</span><span class="hl-7">isArray</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">) &amp;&amp;</span><br/><span class="hl-1">      </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">: </span><span class="hl-3">unknown</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-2">typeof</span><span class="hl-1"> </span><span class="hl-5">song</span><span class="hl-1"> === </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">)) {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">newPlaylist</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Playlist</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">genres:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">genres</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-5">fullSec</span><span class="hl-1"> = </span><span class="hl-8">0</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">songs</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">[] = </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-5">ignored</span><span class="hl-1"> = </span><span class="hl-2">false</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">findOne</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">song</span><span class="hl-1">}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">foundSong</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-5">foundSong</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-5">newPlaylist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">push</span><span class="hl-1">(</span><span class="hl-5">foundSong</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-5">fullSec</span><span class="hl-1"> += </span><span class="hl-5">foundSong</span><span class="hl-1">.</span><span class="hl-5">duration</span><span class="hl-1">.</span><span class="hl-5">sec</span><span class="hl-1"> + </span><span class="hl-5">foundSong</span><span class="hl-1">.</span><span class="hl-5">duration</span><span class="hl-1">.</span><span class="hl-5">min</span><span class="hl-1"> * </span><span class="hl-8">60</span><span class="hl-1">;</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">ignored</span><span class="hl-1"> = </span><span class="hl-2">true</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-5">song</span><span class="hl-1"> === </span><span class="hl-5">songs</span><span class="hl-1">[</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-5">length</span><span class="hl-1"> - </span><span class="hl-8">1</span><span class="hl-1">]) {</span><br/><span class="hl-1">          </span><span class="hl-5">newPlaylist</span><span class="hl-1">.</span><span class="hl-5">duration</span><span class="hl-1"> = {</span><span class="hl-5">min:</span><span class="hl-1"> </span><span class="hl-3">Math</span><span class="hl-1">.</span><span class="hl-7">floor</span><span class="hl-1">(</span><span class="hl-5">fullSec</span><span class="hl-1"> / </span><span class="hl-8">60</span><span class="hl-1">), </span><span class="hl-5">sec:</span><span class="hl-1"> </span><span class="hl-5">fullSec</span><span class="hl-1"> % </span><span class="hl-8">60</span><span class="hl-1">};</span><br/><span class="hl-1">          </span><span class="hl-5">newPlaylist</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">().</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">ignored</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">            } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">                </span><span class="hl-5">warning:</span><span class="hl-1"> </span><span class="hl-4">&quot;Some songs were not found&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">                </span><span class="hl-5">playlist</span><span class="hl-1">,</span><br/><span class="hl-1">              });</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">          }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Songs must be provided as names&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#explicación-4" id="explicación-4" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>Se ejecuta mediante una petición <strong>POST</strong>.
En este router se desarrolla el código para crear los siguientes elementos:</p>
<ul>
<li><strong>Artistas</strong>: Hay que indicar el nombre y los géneros.</li>
<li><strong>Canciones</strong>: Hay que indicar el nombre, el autor, la duración, los géneros, si es single y las reproducciones.</li>
<li><strong>PlayLists</strong>: Hay que indicar el nombre, las canciones y los géneros.</li>
</ul>

<a href="#pruebas" id="pruebas" style="color: inherit; text-decoration: none;">
  <h4>Pruebas</h4>
</a>
<p><img src="/docs/assets/Screenshot_27.png" alt="Prueba1"></p>

<a href="#router-get" id="router-get" style="color: inherit; text-decoration: none;">
  <h3>Router Get</h3>
</a>

<a href="#código-5" id="código-5" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-5">express</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Artist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/artist&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Song</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/song&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Playlist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/playlist&#39;</span><span class="hl-1">;</span><br/><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">getRouter</span><span class="hl-1"> = </span><span class="hl-5">express</span><span class="hl-1">.</span><span class="hl-7">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-9">// Recibe peticiones para obtener artistas por sus nombres</span><br/><span class="hl-5">getRouter</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">filter</span><span class="hl-1"> = </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">?{</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}:{};</span><br/><br/><span class="hl-1">  </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">(</span><span class="hl-5">filter</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">length</span><span class="hl-1"> !== </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">artist</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para obtener canciones por sus nombres</span><br/><span class="hl-5">getRouter</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-4">&#39;/song&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">filter</span><span class="hl-1"> = </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">?{</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}:{};</span><br/><br/><span class="hl-1">  </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">(</span><span class="hl-5">filter</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">length</span><span class="hl-1"> !== </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para obtener playlists por sus nombres</span><br/><span class="hl-5">getRouter</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">filter</span><span class="hl-1"> = </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">?{</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}:{};</span><br/><br/><span class="hl-1">  </span><span class="hl-5">Playlist</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">(</span><span class="hl-5">filter</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-5">playlist</span><span class="hl-1">.</span><span class="hl-5">length</span><span class="hl-1"> !== </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para obtener un artista según su id</span><br/><span class="hl-5">getRouter</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findById</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">artist</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para obtener una cancion según su id</span><br/><span class="hl-5">getRouter</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-4">&#39;/song/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">findById</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">song</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para obtener una cancion según su id</span><br/><span class="hl-5">getRouter</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Playlist</span><span class="hl-1">.</span><span class="hl-7">findById</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">playlist</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#explicación-5" id="explicación-5" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>Se ejecuta mediante una petición <strong>GET</strong>.
En este router se desarrolla el código para obtener la información de los siguientes elementos:</p>
<ul>
<li><strong>Artistas</strong>: Se obtiene la información indicando el nombre o el id. Para el nombre <code>/artist?name=&quot;...&quot;</code>. Para el id <code>/artist?id=&quot;...&quot;</code>.</li>
<li><strong>Canciones</strong>: Se obtiene la información indicando el nombre o el id. Para el nombre <code>/song?name=&quot;...&quot;</code>. Para el id <code>/song?id=&quot;...&quot;</code>.</li>
<li><strong>PlayLists</strong>: Se obtiene la información indicando el nombre o el id. Para el nombre <code>/playlist?name=&quot;...&quot;</code>. Para el id <code>/playlist?id=&quot;...&quot;</code>.</li>
</ul>

<a href="#pruebas-1" id="pruebas-1" style="color: inherit; text-decoration: none;">
  <h4>Pruebas</h4>
</a>
<p><img src="/docs/assets/Screenshot_29.png" alt="Prueba2"></p>

<a href="#router-delete" id="router-delete" style="color: inherit; text-decoration: none;">
  <h3>Router Delete</h3>
</a>

<a href="#código-6" id="código-6" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-5">express</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Playlist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/playlist&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Artist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/artist&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Song</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/song&#39;</span><span class="hl-1">;</span><br/><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">deleteRouter</span><span class="hl-1"> = </span><span class="hl-5">express</span><span class="hl-1">.</span><span class="hl-7">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-9">// Recibe peticiones de eliminación de artistas por su nombre</span><br/><span class="hl-5">deleteRouter</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;A name must be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findOneAndDelete</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">deleteMany</span><span class="hl-1">({</span><span class="hl-5">_id:</span><span class="hl-1"> {</span><span class="hl-5">$in:</span><span class="hl-1"> </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">}}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">            </span><span class="hl-5">artist</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">deletedSongs:</span><span class="hl-1"> </span><span class="hl-5">result</span><span class="hl-1">.</span><span class="hl-5">deletedCount</span><span class="hl-1">,</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones de eliminación de canciones por su nombre</span><br/><span class="hl-5">deleteRouter</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-4">&#39;/song&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;A name must be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">findOneAndDelete</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">song</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findById</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">author</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">          } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">index</span><span class="hl-1"> = </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">_id</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">splice</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-5">index</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">monthlyListeners</span><span class="hl-1"> -= </span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">reproductions</span><span class="hl-1">;</span><br/><br/><span class="hl-1">            </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">().</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">            }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones de eliminación de playlists por su nombre</span><br/><span class="hl-5">deleteRouter</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;A name must be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">Playlist</span><span class="hl-1">.</span><span class="hl-7">findOneAndDelete</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">playlist</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones de eliminación de artistas por su id</span><br/><span class="hl-5">deleteRouter</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findByIdAndDelete</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">deleteMany</span><span class="hl-1">({</span><span class="hl-5">_id:</span><span class="hl-1"> {</span><span class="hl-5">$in:</span><span class="hl-1"> </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">}}).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-5">artist</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-5">deletedSongs:</span><span class="hl-1"> </span><span class="hl-5">result</span><span class="hl-1">.</span><span class="hl-5">deletedCount</span><span class="hl-1">,</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones de eliminación de canciones por su id</span><br/><span class="hl-5">deleteRouter</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-4">&#39;/song/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">findByIdAndDelete</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">song</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findById</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">author</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">index</span><span class="hl-1"> = </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">_id</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">songs</span><span class="hl-1">.</span><span class="hl-7">splice</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-5">index</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-5">monthlyListeners</span><span class="hl-1"> -= </span><span class="hl-5">song</span><span class="hl-1">.</span><span class="hl-5">reproductions</span><span class="hl-1">;</span><br/><br/><span class="hl-1">          </span><span class="hl-5">artist</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">().</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">          }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones de eliminación de playlists por su id</span><br/><span class="hl-5">deleteRouter</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">Playlist</span><span class="hl-1">.</span><span class="hl-7">findByIdAndDelete</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">playlist</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-7">catch</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#explicación-6" id="explicación-6" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>Se ejecuta mediante una petición <strong>DELETE</strong>.
En este router se desarrolla el código para eliminar los siguientes elementos:</p>
<ul>
<li><strong>Artistas</strong>: Se elimina el artista indicando el nombre o el id. Para el nombre <code>/artist?name=&quot;...&quot;</code>. Para el id <code>/artist?id=&quot;...&quot;</code>.</li>
<li><strong>Canciones</strong>: Se elimina la canción indicando el nombre o el id. Para el nombre <code>/song?name=&quot;...&quot;</code>. Para el id <code>/song?id=&quot;...&quot;</code>.</li>
<li><strong>PlayLists</strong>: Se elimina la playlist indicando el nombre o el id. Para el nombre <code>/playlist?name=&quot;...&quot;</code>. Para el id <code>/playlist?id=&quot;...&quot;</code>.</li>
</ul>

<a href="#pruebas-2" id="pruebas-2" style="color: inherit; text-decoration: none;">
  <h4>Pruebas</h4>
</a>
<p><img src="/docs/assets/Screenshot_28.png" alt="Prueba3"></p>

<a href="#router-patch" id="router-patch" style="color: inherit; text-decoration: none;">
  <h3>Router Patch</h3>
</a>

<a href="#código-7" id="código-7" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-5">express</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Artist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/artist&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Song</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/song&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-5">Playlist</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;../models/playlist&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">patchRouter</span><span class="hl-1"> = </span><span class="hl-5">express</span><span class="hl-1">.</span><span class="hl-7">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-9">// Recibe peticiones para actualizar un artista según su nombre</span><br/><span class="hl-5">patchRouter</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;A name must be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">allowedUpdates</span><span class="hl-1"> = [</span><span class="hl-4">&#39;name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;genre&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;songs&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;monthlyListeners&#39;</span><span class="hl-1">];</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">actualUpdates</span><span class="hl-1"> = </span><span class="hl-3">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">isValidUpdate</span><span class="hl-1"> =</span><br/><span class="hl-1">      </span><span class="hl-5">actualUpdates</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">update</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-5">allowedUpdates</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">update</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">isValidUpdate</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Update is not permitted&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findOneAndUpdate</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}, </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-5">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">artist</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><br/><span class="hl-9">// Recibe peticiones para actualizar un artista según su id</span><br/><span class="hl-5">patchRouter</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-4">&#39;/artist/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">allowedUpdates</span><span class="hl-1"> = [</span><span class="hl-4">&#39;name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;genre&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;songs&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;monthlyListeners&#39;</span><span class="hl-1">];</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">actualUpdates</span><span class="hl-1"> = </span><span class="hl-3">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">isValidUpdate</span><span class="hl-1"> =</span><br/><span class="hl-1">      </span><span class="hl-5">actualUpdates</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">update</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-5">allowedUpdates</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">update</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">isValidUpdate</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Update is not permitted&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">Artist</span><span class="hl-1">.</span><span class="hl-7">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">, </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-5">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">artist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">artist</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">artist</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-9">// Updates song</span><br/><span class="hl-5">patchRouter</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-4">&#39;/song&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;A name must be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">allowedUpdates</span><span class="hl-1"> = [</span><span class="hl-4">&#39;name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;duration&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;genre&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;single&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;reproductions&#39;</span><span class="hl-1">];</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">actualUpdates</span><span class="hl-1"> = </span><span class="hl-3">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">isValidUpdate</span><span class="hl-1"> =</span><br/><span class="hl-1">      </span><span class="hl-5">actualUpdates</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">update</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-5">allowedUpdates</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">update</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">isValidUpdate</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Update is not permitted&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">findOneAndUpdate</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}, </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-5">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">song</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-9">// Modificar canciones según su id</span><br/><span class="hl-5">patchRouter</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-4">&#39;/song/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">allowedUpdates</span><span class="hl-1"> = [</span><span class="hl-4">&#39;name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;duration&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;genre&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;single&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;reproductions&#39;</span><span class="hl-1">];</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">actualUpdates</span><span class="hl-1"> = </span><span class="hl-3">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">isValidUpdate</span><span class="hl-1"> =</span><br/><span class="hl-1">      </span><span class="hl-5">actualUpdates</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">update</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-5">allowedUpdates</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">update</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">isValidUpdate</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Update is not permitted&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">Song</span><span class="hl-1">.</span><span class="hl-7">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">, </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-5">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">song</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">song</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">song</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-9">// Updates playlist</span><br/><span class="hl-5">patchRouter</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;A name must be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">allowedUpdates</span><span class="hl-1"> = [</span><span class="hl-4">&#39;name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;songs&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;genres&#39;</span><span class="hl-1">];</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">actualUpdates</span><span class="hl-1"> = </span><span class="hl-3">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">isValidUpdate</span><span class="hl-1"> =</span><br/><span class="hl-1">      </span><span class="hl-5">actualUpdates</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">update</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-5">allowedUpdates</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">update</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">isValidUpdate</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Update is not permitted&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">Playlist</span><span class="hl-1">.</span><span class="hl-7">findOneAndUpdate</span><span class="hl-1">({</span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">query</span><span class="hl-1">.</span><span class="hl-5">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">()}, </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-5">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">playlist</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-9">// Modificar playlist según su id</span><br/><span class="hl-5">patchRouter</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-4">&#39;/playlist/:id&#39;</span><span class="hl-1">, (</span><span class="hl-5">req</span><span class="hl-1">, </span><span class="hl-5">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">allowedUpdates</span><span class="hl-1"> = [</span><span class="hl-4">&#39;name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;songs&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;genres&#39;</span><span class="hl-1">];</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">actualUpdates</span><span class="hl-1"> = </span><span class="hl-3">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">isValidUpdate</span><span class="hl-1"> =</span><br/><span class="hl-1">      </span><span class="hl-5">actualUpdates</span><span class="hl-1">.</span><span class="hl-7">every</span><span class="hl-1">((</span><span class="hl-5">update</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-5">allowedUpdates</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">update</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">isValidUpdate</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">&#39;Update is not permitted&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">Playlist</span><span class="hl-1">.</span><span class="hl-7">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">params</span><span class="hl-1">.</span><span class="hl-5">id</span><span class="hl-1">, </span><span class="hl-5">req</span><span class="hl-1">.</span><span class="hl-5">body</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-5">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-5">playlist</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">playlist</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">();</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">playlist</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }).</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-5">error</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">(</span><span class="hl-5">error</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#explicación-7" id="explicación-7" style="color: inherit; text-decoration: none;">
  <h4>Explicación</h4>
</a>
<p>Se ejecuta mediante una petición <strong>PATCH</strong>.
En este router se desarrolla el código para modificar información de los siguientes elementos:</p>
<ul>
<li><strong>Artistas</strong>: Se modifica el artista indicando el nombre o el id. Para el nombre <code>/artist?name=&quot;...&quot;</code>. Para el id <code>/artist?id=&quot;...&quot;</code>. Se incluye en el <em>JSON</em> de la petición la información del artista que se va a modificar.</li>
<li><strong>Canciones</strong>: Se modifica la canción indicando el nombre o el id. Para el nombre <code>/song?name=&quot;...&quot;</code>. Para el id <code>/song?id=&quot;...&quot;</code> Se incluye en el <em>JSON</em> de la petición la información de la canción que se va a modificar.</li>
<li><strong>PlayLists</strong>: Se elimina la playlist indicando el nombre o el id. Para el nombre <code>/playlist?name=&quot;...&quot;</code>. Para el id <code>/playlist?id=&quot;...&quot;</code> Se incluye en el <em>JSON</em> de la petición la información de la playlist que se va a modificar.</li>
</ul>

<a href="#pruebas-3" id="pruebas-3" style="color: inherit; text-decoration: none;">
  <h4>Pruebas</h4>
</a>
<p><img src="/docs/assets/Screenshot_30.png" alt="Prueba4"></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="modules/models_artist.html">models/artist</a></li><li class=" tsd-kind-module"><a href="modules/models_genre.html">models/genre</a></li><li class=" tsd-kind-module"><a href="modules/models_playlist.html">models/playlist</a></li><li class=" tsd-kind-module"><a href="modules/models_song.html">models/song</a></li><li class=" tsd-kind-module"><a href="modules/routers_default.html">routers/default</a></li><li class=" tsd-kind-module"><a href="modules/routers_delete.html">routers/delete</a></li><li class=" tsd-kind-module"><a href="modules/routers_get.html">routers/get</a></li><li class=" tsd-kind-module"><a href="modules/routers_patch.html">routers/patch</a></li><li class=" tsd-kind-module"><a href="modules/routers_post.html">routers/post</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>